extends base

block content 
  div#videoContainer(data-id=video._id, tabindex="-1")
    video(src="/"+video.fileUrl)
    div#videoControls.videoControls
      div.videoControls__play
        span#play.videoControls__playBtn
          i.fas.fa-play
        div.videoControls__time
          span#currentTime 00:00
          span  / 
          span#totalTime 00:00
      input(type="range", step="1", value=0, min="0")#timeline.videoControls__timeline
      div.videoControls__volume
        input(type="range", step="0.1", value="0.5", min="0", max="1")#volume
        span#mute
          i.fas.fa-volume-up
      div.videoControls__fullScreen
        span#fullScreen
          i.fas.fa-expand

  div.video__data
    div.video__data-box
      div.video__data-info
        p.video__title=video.title
        small.video__owner Uploaded by 
          a(href=`/users/${video.owner._id}`)=video.owner.name
        small.video__createdAt=new Date(video.createdAt).toLocaleDateString("ko-ko", {weekday: "long", year: "numeric", month: "long", day: "numeric"})
      if String(loggedInUser._id) !== String(video.owner._id)
        div.follow-box
          if followIndex === -1
            .follow#follow(data-followid=loggedInUser._id, data-followingid=video.owner._id)
              span#followSpan Íµ¨ÎèÖ
          else
            div.follow.following#follow(data-followid=loggedInUser._id, data-followingid=video.owner._id)
              span#followSpan Íµ¨ÎèÖÏ§ë
          span#followers Íµ¨ÎèÖÏûê #{video.owner.followers}Î™Ö
    if String(video.owner._id) === String(loggedInUser._id)
      a(href=`${video.id}/edit`) Edit video &rarr;
      br
      a(href=`${video.id}/delete`) Delete video &rarr;

  if loggedIn
    div.video__add-comments
      form.video__comment-form#commentForm
        textarea(cols="60", rows="2", placeholder="Write a nice comment...")
        button Add comment

  div.video__comments
    ul
      each comment in video.comments.reverse()
        li.video__comment(data-id=comment._id)
          div.video__comment-text
            i.fas.fa-comment
            span #{comment.text}
          if String(comment.owner._id) === String(loggedInUser._id) || String(video.owner._id) === String(loggedInUser._id)
            div.video__comment-btn
              span.delete__btn ‚ùå
              if String(comment.owner._id) === String(loggedInUser._id)
                span.modify__btn üí¨


block scripts
  script(src="/static/js/videoPlayer.js") 
  if loggedIn
    script(src="/static/js/commentSection.js") 
    script(src="/static/js/follow.js") 